import{d as B,P as x}from"./PageLoading.eb846872.js";import{d as S,l as V,u as q,m as L,K as k,o as M,bd as D,af as E,c as r,b as n,j as R,S as U,e as d,a as O,f as l,t as c,F as w,r as F,h as i,_ as P}from"./index.77958336.js";const j={key:1},G={key:2,class:"wrapper container"},K={class:"collection-header"},Q={class:"collection-name"},z={class:"collection-address"},A={class:"nft-container"},H=["src"],J={class:"commitment"},W={key:3,class:"wrapper container"},X={class:"collection-header"},Y={class:"collection-name"},Z={class:"collection-address"},ee={class:"nft-container"},te=["src"],ae={class:"commitment"},oe=S({__name:"NFTCollectionView",props:{address:{type:String,required:!0},tokenId:{type:String,required:!0}},setup(b){const s=b,T=V(),e=q(),u=L(),y=k(0),g=k([]),m=k([]),v=k([]),h=k("");M(async()=>{e.validatedQuery.query===s.address?await f():(e.query=s.address,e.type="path",await e.search(s.tokenId).then(async()=>{await f()}))}),D([()=>s.address,()=>s.tokenId],async([o,a])=>{e.query=o,e.type="path",m.value=[],await e.search(a).then(async()=>{await f()})});async function f(){m.value=[],v.value=[],h.value=e.getNftCollectionNameById(s.tokenId),y.value=e.wallet?await e.wallet.getNftTokenBalance(s.tokenId):0,g.value=e.wallet?await e.wallet.getTokenUtxos(s.tokenId):[],g.value.forEach(o=>{if(o.token?.tokenId&&o.token?.commitment){let a=e.getNftCollectionById(o.token.tokenId),t=e.getNftDetailByCommitment(o.token.tokenId,o.token.commitment);t?m.value.push({id:o.token.tokenId,commitment:o.token.commitment,nftType:t}):v.value.push({id:o.token.tokenId,category:a?.BCMR?.token?.category,symbol:a?.BCMR?.token?.symbol,icon:a?.BCMR?.uris?.icon})}})}const p=E(()=>h.value?h.value:`${s.tokenId.slice(0,4)}...${s.tokenId.slice(-4)}`);function I(o){if(o&&o.slice(0,7)==="ipfs://"){let a=T.ipfsGateway,t=o.slice(7);return a+t}else if(o)return o}function $(o,a,t){let _=`${a}/${t}`;u.add(_,o)}function C(o,a){let t=`${o}/${a}`;u.remove(t)}async function N(o,a){const t=window.location.origin,_=B.exports.useToast();await navigator.clipboard.writeText(`${t}/collection/${o}/${a}`).then(()=>{_.open({message:"Link copied to clipboard",type:"success",position:"top-right",duration:5e3})})}return(o,a)=>(i(),r(w,null,[n(e).error!==null?(i(),R(U,{key:0,error:n(e).error,type:"page"},null,8,["error"])):d("",!0),m.value.length===0&&v.value.length===0&&n(e).error===null?(i(),r("div",j,[O(x)])):d("",!0),m.value.length!==0?(i(),r("div",G,[l("div",K,[l("h3",Q,c(p.value),1),l("div",z,[l("div",null,"On address: "+c(n(e).wallet?.tokenaddr),1),l("div",null,"Child NFTs: "+c(y.value),1)]),l("span",{class:"share material-symbols-outlined",onClick:a[0]||(a[0]=t=>N(n(e).wallet?.cashaddr,s.tokenId))}," share "),n(u).isFav(`${n(e).wallet?.cashaddr}/${s.tokenId}`)?d("",!0):(i(),r("span",{key:0,class:"favorite material-symbols-outlined",onClick:a[1]||(a[1]=t=>$(p.value,n(e).wallet?.cashaddr,s.tokenId))}," favorite ")),n(u).isFav(`${n(e).wallet?.cashaddr}/${s.tokenId}`)?(i(),r("span",{key:1,class:"favorite material-symbols-outlined red",onClick:a[2]||(a[2]=t=>C(n(e).wallet?.cashaddr,s.tokenId))}," favorite ")):d("",!0)]),l("div",A,[(i(!0),r(w,null,F(m.value,t=>(i(),r("div",{class:"nft-card",key:t.commitment},[t.nftType.uris?.icon?(i(),r("img",{key:0,src:I(t.nftType.uris.icon)},null,8,H)):d("",!0),l("p",null,c(t.nftType.name),1),l("p",J,"Commitment: "+c(t.commitment),1)]))),128))])])):d("",!0),v.value.length!==0?(i(),r("div",W,[l("div",X,[l("h3",Y,c(p.value),1),l("div",Z,[l("div",null,"On address: "+c(n(e).wallet?.tokenaddr),1),l("div",null,"Child NFTs: "+c(y.value),1)]),l("span",{class:"share material-symbols-outlined",onClick:a[3]||(a[3]=t=>N(n(e).wallet?.cashaddr,s.tokenId))}," share "),n(u).isFav(`${n(e).wallet?.cashaddr}/${s.tokenId}`)?d("",!0):(i(),r("span",{key:0,class:"favorite material-symbols-outlined",onClick:a[4]||(a[4]=t=>$(p.value,n(e).wallet?.cashaddr,s.tokenId))}," favorite ")),n(u).isFav(`${n(e).wallet?.cashaddr}/${s.tokenId}`)?(i(),r("span",{key:1,class:"favorite material-symbols-outlined red",onClick:a[5]||(a[5]=t=>C(n(e).wallet?.cashaddr,s.tokenId))}," favorite ")):d("",!0)]),l("div",ee,[(i(!0),r(w,null,F(v.value,t=>(i(),r("div",{class:"nft-card",key:t.category},[t.icon?(i(),r("img",{key:0,src:I(t.icon)},null,8,te)):d("",!0),l("p",ae,"1 "+c(t.symbol),1)]))),128))])])):d("",!0)],64))}});const le=P(oe,[["__scopeId","data-v-715a58f9"]]);export{le as default};
